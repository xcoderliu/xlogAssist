<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xlogAssist - 日志分析工具</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>xlogAssist</h1>
        </header>

        <div class="main-content">
            <!-- 左侧日志显示区域 -->
            <div class="log-display-area" id="logDisplayArea">
                <div class="upload-section">
                    <div class="drop-zone" id="dropZone">
                        <div class="drop-content">
                            <span class="drop-icon">📁</span>
                            <p>拖拽日志文件到这里上传</p>
                            <p class="drop-hint">或者点击选择文件</p>
                        </div>
                        <input type="file" id="fileInput" accept=".log,.txt,.json" multiple style="display: none;">
                    </div>
                </div>

                <div class="log-controls">
                    <div class="search-controls">
                        <div class="search-box">
                            <input type="text" id="searchInput" placeholder="搜索关键词..." class="search-input">
                            <button id="searchBtn" class="btn btn-small">搜索</button>
                            <button id="prevMatch" class="btn btn-small" style="display: none;">上一个</button>
                            <button id="nextMatch" class="btn btn-small" style="display: none;">下一个</button>
                            <button id="clearSearch" class="btn btn-small" style="display: none;">清除搜索</button>
                        </div>
                        <div class="filter-box">
                            <input type="text" id="filterInput" placeholder="过滤关键词..." class="search-input">
                            <button id="filterBtn" class="btn btn-small">过滤</button>
                            <button id="clearFilter" class="btn btn-small" style="display: none;">清除过滤</button>
                        </div>
                    </div>
                    <div class="control-buttons">
                        <button id="clearLogs" class="btn">清空日志</button>
                        <button id="exportLogs" class="btn">导出日志</button>
                    </div>
                </div>

                <div class="log-container">
                    <div class="log-header">
                        <span>日志内容</span>
                        <span class="log-count" id="logCount">0 行</span>
                    </div>
                    <div class="log-content" id="logContent">
                        <div class="empty-state">
                            <p>暂无日志内容</p>
                            <p>请上传日志文件开始分析</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 分隔条 -->
            <div class="resizer" id="resizer"></div>
            
            <!-- 右侧排查区域 -->
            <div class="investigation-area" id="investigationArea">
                <div class="investigation-header">
                    <h3>排查区</h3>
                    <div class="investigation-controls">
                        <button id="clearInvestigation" class="btn btn-small">清空</button>
                        <button id="exportInvestigation" class="btn btn-small">导出</button>
                    </div>
                </div>
                <div class="investigation-content" id="investigationContent">
                    <div class="empty-state">
                        <p>暂无排查日志</p>
                        <p>右键日志行添加到排查区</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 日志右键菜单 -->
        <div class="context-menu" id="contextMenu">
            <div class="menu-item" data-action="add-to-investigation">加入排查区</div>
            <div class="menu-item" data-action="copy-line">复制此行</div>
        </div>

        <!-- 排查区右键菜单 -->
        <div class="context-menu" id="investigationContextMenu">
            <div class="menu-item" data-action="remove-from-investigation">从排查区移除</div>
            <div class="menu-item" data-action="copy-line">复制此行</div>
        </div>

        <!-- 配置面板 -->
        <div class="config-panel" id="configPanel">
            <div class="config-header">
                <h3>正则配置</h3>
                <div class="config-actions">
                    <button id="exportConfig" class="btn btn-small">导出配置</button>
                    <button id="importConfig" class="btn btn-small">导入配置</button>
                    <input type="file" id="importConfigFile" accept=".json" style="display: none;">
                </div>
                <button class="close-btn" id="closeConfig">×</button>
            </div>
            <div class="config-content">
                <div class="config-tabs">
                    <button class="tab-btn active" data-tab="rules">规则管理</button>
                    <button class="tab-btn" data-tab="groups">配置组</button>
                </div>
                
                <!-- 规则管理标签页 -->
                <div class="tab-content active" data-tab="rules">
                    <div class="config-item">
                        <label>正则表达式:</label>
                        <input type="text" id="regexPattern" placeholder="例如: error|ERROR">
                    </div>
                    <div class="config-item">
                        <label>文本颜色:</label>
                        <input type="color" id="regexColor" value="#ffffff">
                    </div>
                    <div class="config-item">
                        <label>背景颜色:</label>
                        <input type="color" id="regexBgColor" value="#dc3545">
                    </div>
                    <div class="config-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="highlightWholeLine"> 高亮整行
                        </label>
                    </div>
                    <button id="addRegexRule" class="btn">添加规则</button>
                    
                    <div class="rules-list" id="rulesList">
                        <h4>当前规则:</h4>
                        <div class="empty-rules">暂无规则</div>
                    </div>
                </div>
                
                <!-- 配置组标签页 -->
                <div class="tab-content" data-tab="groups">
                    <div class="config-item">
                        <label>配置组名称:</label>
                        <input type="text" id="groupName" placeholder="例如: 登录问题排查">
                    </div>
                    <button id="createGroup" class="btn">创建配置组</button>
                    
                    <div class="groups-list" id="groupsList">
                        <h4>配置组列表:</h4>
                        <div class="empty-groups">暂无配置组</div>
                    </div>
                    
                    <div class="group-selection" id="groupSelection" style="display: none;">
                        <h4>选择生效的配置组:</h4>
                        <div class="group-checkboxes" id="groupCheckboxes"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 配置组规则管理模态框 -->
        <div class="group-rules-modal" id="groupRulesModal">
            <div class="modal-header">
                <h3 class="modal-title">管理配置组</h3>
                <button class="close-btn" onclick="document.getElementById('groupRulesModal').style.display='none'">×</button>
            </div>
            <div class="modal-body">
                <!-- 内容由JavaScript动态生成 -->
            </div>
        </div>

        <footer>
            <button id="configBtn" class="btn">配置</button>
            <span class="status" id="status">就绪</span>
        </footer>
    </div>

    <script type="module" src="main.js"></script>
</body>
</html>